% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
% ER-digram i kråkefot-notasjon
% Basert på kode fra: https://tex.stackexchange.com/questions/462914/how-to-create-an-er-diagram-using-tikzpicture-environment
% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
\usepackage{array}
\usetikzlibrary{shapes.multipart, shadows, positioning, calc}

% Label 
\tikzset{pics/label near/.style n args={4}{code={
    \node[at=($(#2)!0.55!(#3)$),label=#4:{\scriptsize\ttfamily{#1}},outer sep=0pt,minimum size=0pt,fill=white]{};
}}}

% Entity
\tikzset{pics/entity/.style n args={3}{code={
    \node[draw,
    rectangle split,
    rectangle split parts=2,
    font=\scriptsize\ttfamily,
    fill=white,
    drop shadow={opacity=0.25},
    text height=1.5ex,
    ] (#1)
    {\small{#2} \nodepart{second}
    \begin{tabular}{>{\raggedright\arraybackslash}p{4.5em}>{\raggedright\arraybackslash}p{11.5em}}
    #3
    \end{tabular}};
}}}

% Weak entity
\tikzset{pics/weak entity/.style n args={3}{code={
    \node[draw,
    rounded corners=4pt, 
    rectangle split,
    rectangle split parts=2,
    font=\scriptsize\ttfamily,
    fill=white,
    drop shadow={opacity=0.25},
    text height=1.5ex,
    ] (#1)
    {\small{#2} \nodepart{second}
    \begin{tabular}{>{\raggedright\arraybackslash}p{4.5em}>{\raggedright\arraybackslash}p{11.5em}}
    #3
    \end{tabular}};
}}}
\pgfdeclarearrow{
    name = mmany,
    parameters = {}, setup code = {}, defaults = {},
    drawing code={
        \newdimen\arrowsize%
        \arrowsize=0.5pt%
        \pgfsetdash{}{+0pt}%
        \pgfsetmiterjoin%
        \advance\arrowsize by .25\pgflinewidth%
        \pgfpathmoveto{\pgfqpoint{0pt}{0pt}}%
        \pgfpathlineto{\pgfqpoint{-13\arrowsize}{0pt}}%
        \pgfpathlineto{\pgfqpoint{0pt}{9\arrowsize}}%
        \pgfpathlineto{\pgfqpoint{-13\arrowsize}{0pt}}%
        \pgfpathlineto{\pgfqpoint{0pt}{-9\arrowsize}}%
        \pgfpathmoveto{\pgfqpoint{-19\arrowsize}{-10\arrowsize}}% 
        \pgfpathlineto{\pgfqpoint{-19\arrowsize}{10\arrowsize}}% 
        \pgfusepathqstroke%
    }
}

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 

\pgfdeclarearrow{
    name = omany, 
    parameters = {}, setup code = {}, defaults = {},
    drawing code = {
        \newdimen\arrowsize%
        \arrowsize=0.5pt%
        \pgfsetdash{}{+0pt}%
        \pgfsetmiterjoin%
        \advance\arrowsize by .25\pgflinewidth%
        \pgfpathmoveto{\pgfqpoint{0pt}{0pt}}%
        \pgfpathlineto{\pgfqpoint{-13\arrowsize}{0pt}}%
        \pgfpathlineto{\pgfqpoint{0pt}{9\arrowsize}}%
        \pgfpathlineto{\pgfqpoint{-13\arrowsize}{0pt}}%
        \pgfpathlineto{\pgfqpoint{0pt}{-9\arrowsize}}%
        \pgfusepathqstroke%
        \pgfsetfillcolor{white}
        \pgfpathcircle{\pgfpoint{-19\arrowsize}{0}} {6\arrowsize}%
        \pgfusepathqfillstroke%
    }
}

\pgfdeclarearrow{
    name = mone,
    parameters = {}, setup code = {}, defaults = {},
    drawing code = {
        \newdimen\arrowsize%
        \arrowsize=0.5pt%%
        \pgfsetdash{}{+0pt}%
        \pgfsetmiterjoin%
        \advance\arrowsize by .25\pgflinewidth%
        \pgfpathmoveto{\pgfqpoint{-9\arrowsize}{-10\arrowsize}}% 
        \pgfpathlineto{\pgfqpoint{-9\arrowsize}{10\arrowsize}}% 
        \pgfpathmoveto{\pgfqpoint{-19\arrowsize}{-10\arrowsize}}% 
        \pgfpathlineto{\pgfqpoint{-19\arrowsize}{10\arrowsize}}%    
        \pgfusepathqstroke%
    }
}

\pgfdeclarearrow{
    name = oone,
    parameters = {}, setup code = {}, defaults = {},
    drawing code = {
        \newdimen\arrowsize%
        \arrowsize=0.5pt%
        \pgfsetdash{}{+0pt}%
        \pgfsetmiterjoin%
        \advance\arrowsize by .25\pgflinewidth
        \pgfpathmoveto{\pgfqpoint{-9\arrowsize}{-10\arrowsize}}% 
        \pgfpathlineto{\pgfqpoint{-9\arrowsize}{10\arrowsize}}% 
        \pgfsetfillcolor{white}
        \pgfpathcircle{\pgfpoint{-19\arrowsize}{0}} {6\arrowsize}%
        \pgfusepathqfillstroke%
    }
}
